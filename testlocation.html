<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>containsLocation()</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 90%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>


    <input id="pac-input" class="controls" type="text"
placeholder="Enter a location">	
    <div id="map"></div>
    <script>
      // This example requires the Geometry library. Include the libraries=geometry
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=geometry">
        var map;
        var geocoder; //Added on 27/09/2016
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 47.6145714, lng: -122.3278329},
          zoom: 14,
          scaleControl: true
        });

        bounds = new google.maps.LatLngBounds();
        google.maps.event.addListenerOnce(map, 'tilesloaded', function(evt) { 
        bounds = map.getBounds();
        });
        marker = new google.maps.Marker({
          center: {lat: 47.6145714, lng: -122.3278329}
        });
        polygon = new google.maps.Polygon({
        path: area,
        geodesic: true,
        strokeColor: '#FFd000',
        strokeOpacity: 1.0,
        strokeWeight: 4,
        fillColor: '#FFd000',
        fillOpacity: 0.35
        });

        polygon.setMap(map);	



        var input = /** @type {!HTMLInputElement} */(
		document.getElementById('pac-input'));
        var types = document.getElementById('type-selector');
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(types);

        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.addListener('place_changed', function() {
		marker.setMap(null);
		var place = autocomplete.getPlace();
		var newBounds = new google.maps.LatLngBounds(bounds.getSouthWest(), bounds.getNorthEast()); //Changed
		// removed newBounds = bounds;
          if (!place.geometry) {
						geocodeAddress(input.value);//Added on 27/09/2016          
            //window.alert("Autocomplete's returned place contains no geometry");
            return;
          };
		  marker.setPosition(place.geometry.location);
		  marker.setMap(map);
		  newBounds.extend(place.geometry.location);
		  map.fitBounds(newBounds);
		  if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)){
			alert('The area contains the address');  
		  } else {
			alert('The address is outside of the area.');  
		  };
	   });
}
//Added on 27/09/2016
//*************************
function geocodeAddress(addr) {
	geocoder.geocode({'address': addr}, function(results, status) {
	  if (status === 'OK') {
  		var newBounds = new google.maps.LatLngBounds(bounds.getSouthWest(), bounds.getNorthEast());
		  marker.setPosition(results[0].geometry.location);
		  marker.setMap(map);
		  newBounds.extend(results[0].geometry.location);
		  map.fitBounds(newBounds);
		  if (google.maps.geometry.poly.containsLocation(results[0].geometry.location, polygon)){
			alert('The area contains the address');  
		  } else {
			alert('The address is outside of the area.');  
		  };
	  } else {
		alert('Geocode was not successful for the following reason: ' + status);
	  }
	});






      };








      var area= [
      {lat: 46.6145714, lng: -122.3278329},
      {lat: 47.6145714, lng: -121.3278329},
      {lat: 48.6145714, lng: -122.3278329},
      {lat: 47.6145714, lng: -123.3278329}
];



    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwegA6SBLg8wfP47WBd-bj-_ghO9kRTs8&libraries=geometry,places&callback=initMap"
         async defer></script>
  </body>
</html>

